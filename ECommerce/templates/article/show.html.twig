{% extends 'base.html.twig' %}

{% block title %}Article{% endblock %}

{% block body %}

    <link href="{{ asset('css/Article.css') }}" rel="stylesheet"/>

    <div class="article">
        <div>
            {% for image in article.images %}
                <img src="{{ image.lien }}" class="img-100"/>
            {% endfor %}
        </div>
        <p>{{ article.nom }}</p>
    </div>

    <table class="table">
        <tbody>
        <tr>
            <th>Categorie</th>
            <td>{{ article.categorie }}</td>
        </tr>
        <tr>
            <th>Description</th>
            <td>{{ article.description }}</td>
        </tr>
        <tr>
            <th>Caracteristiques</th>
            <td>{{ article.caracteristiques }}</td>
        </tr>
        <tr>
            <th>PrixUnitaire</th>
            <td>{{ article.prixUnitaire }}</td>
        </tr>
        <tr>
            <th>QteEnStock</th>
            <td>{{ article.qteEnStock }}</td>
        </tr>
        </tbody>
    </table>

    <div>
        <label>Quantit√©:</label>
        <input type="number" id="qty" value="1">
    </div>
    <button id="test"> Ajouter au panier</button>

    <a href="{{ path('article_index') }}">back to list</a>

    <a href="{{ path('article_edit', {'id': article.id}) }}">edit</a>

    {{ include('article/_delete_form.html.twig') }}

    <script>
        let imageArticle;
        {% for image in article.images %}
        {% if loop.first %}
        imageArticle = "{{ image.lien }}";
        {% endif %}
        {% endfor %}
        $('#test').click(function () {
            let data = {
                id: "{{ article.id }}",
                nom: "{{ article.nom }}",
                qty: $('#qty').val(),
                unitPrice: {{ article.prixUnitaire }},
                image: imageArticle
            };
            $.ajax({
                type: "POST",
                url: '/addToCart',
                data: data,
                success: function (data) {
                    console.log(data);
                }
            });
        });

        function removeFromCart(id) {
            let data = {
                id: id
            };
            $.ajax({
                type: "POST",
                url: '/removeFromCart',
                data: data,
                success: function (data) {
                    console.log(data);
                }
            });
        }
    </script>
{% endblock %}
